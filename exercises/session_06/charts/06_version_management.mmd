%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#e3f2fd', 'primaryTextColor': '#0d47a1', 'primaryBorderColor': '#1976d2', 'lineColor': '#1976d2', 'secondaryColor': '#fff3e0', 'tertiaryColor': '#f3e5f5'}}}%%
flowchart LR
    subgraph Registry["PromptRegistry"]
        direction TB
        V1["v1<br/>Original prompt<br/>Baseline scores"]
        V2["v2<br/>Improved completeness<br/>Fixed regressions"]
        V3["v3<br/>Better status handling<br/>All tests pass"]

        V1 --> V2
        V2 --> V3
    end

    subgraph Aliases["Aliases"]
        direction TB
        STABLE["stable → v2<br/>(production)"]
        LATEST["latest → v3<br/>(newest)"]
        CANARY["canary → v3<br/>(testing 10%)"]
    end

    subgraph Operations["Operations"]
        direction TB
        GET["registry.get('stable')<br/>Returns v2 prompt"]
        PROMOTE["Promote v3 to stable<br/>after canary succeeds"]
        ROLLBACK["Rollback: point<br/>stable back to v1"]
    end

    Registry --> Aliases
    Aliases --> Operations

    style Registry fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    style Aliases fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    style Operations fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    style V1 fill:#bbdefb,stroke:#1976d2
    style V2 fill:#90caf9,stroke:#1565c0
    style V3 fill:#64b5f6,stroke:#0d47a1,stroke-width:3px
    style STABLE fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px
    style ROLLBACK fill:#fff9c4,stroke:#f9a825
