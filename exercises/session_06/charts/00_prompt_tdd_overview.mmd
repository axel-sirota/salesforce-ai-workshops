%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#e1f5fe', 'primaryTextColor': '#01579b', 'primaryBorderColor': '#0288d1', 'lineColor': '#0288d1', 'secondaryColor': '#fff3e0', 'tertiaryColor': '#f3e5f5'}}}%%
flowchart TB
    subgraph TDD["Prompt TDD Cycle"]
        direction TB
        WRITE["1. Write Test<br/>Define what 'good'<br/>looks like"]
        RED["2. Run Test (RED)<br/>Current prompt<br/>fails the test"]
        IMPROVE["3. Improve Prompt<br/>Modify wording,<br/>add instructions"]
        GREEN["4. Run Test (GREEN)<br/>New prompt<br/>passes the test"]
        REGRESS["5. Run ALL Tests<br/>Check nothing<br/>broke"]
        VERSION["6. Version & Deploy<br/>Register in<br/>PromptRegistry"]

        WRITE --> RED
        RED --> IMPROVE
        IMPROVE --> GREEN
        GREEN --> REGRESS
        REGRESS -->|"All pass"| VERSION
        REGRESS -->|"Regression!"| IMPROVE
    end

    subgraph Tools["Our Stack"]
        direction TB
        T1["G-Eval Metrics<br/>(DeepEval)"]
        T2["Judge: Gemini Flash<br/>(cross-model eval)"]
        T3["PromptRegistry<br/>(version control)"]
        T4["DevHub Agent<br/>(real LLM calls)"]
    end

    style TDD fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    style RED fill:#ffcdd2,stroke:#c62828,stroke-width:3px
    style GREEN fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px
    style REGRESS fill:#fff9c4,stroke:#f9a825,stroke-width:2px
    style VERSION fill:#c8e6c9,stroke:#2e7d32
    style Tools fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
